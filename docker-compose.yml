version: '3.8'
services:
  mongodb:
    build: 
      dockerfile: Dockerfile
      context: ./data-persistence/mongodb
  server:
    build:
      dockerfile: Dockerfile.dev
      context: ./microservices/user-service
    ports:
      - '6008:6008'
    depends_on:
      - mongodb
    volumes:
      - /app/node_modules
      - ./microservices/user-service:/app
  nginx:
    restart: always
    build:
      context: ./microservices/api-proxy-server
      dockerfile: DockerFile.dev
    ports:
      - '4000:80'
  customer:
    container_name: customer
    restart: always
    build:
      context: ./microservices/customer-service
      dockerfile: DockerFile.dev
    volumes:
      - /app/node_modules
      - ./microservices/customer-service:/app
  supplier:
    container_name: supplier
    restart: always
    build:
      context: ./microservices/supplier-service
      dockerfile: DockerFile.dev
    volumes:
      - /app/node_modules
      - ./microservices/supplier-service:/app  
  product:
    container_name: product
    restart: always
    build:
      context: ./microservices/product-service
      dockerfile: DockerFile.dev
    volumes:
      - /app/node_modules
      - ./microservices/product-service:/app